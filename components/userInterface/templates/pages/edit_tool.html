{% load static %}
{% load widget_tweaks %}

{% block breadcrumbs %}{% endblock breadcrumbs %}

{% block content %}
<div class="card px-0 py-3" style="border-radius: 15px;">
    <div class="wrapper-create-work">
        <form method="POST">
            {% csrf_token %}
            <div>
                <button name="deleteCustom{{name}}" type="submit" class="btn btn-danger ml-2">Delete tool</button>
                <a href="{% url 'edit_tool' tool_name=name %}">
                    <button type="button" class="btn btn-primary">Edit tool</button>
                </a>
            </div>
        </form>

        <h2 class="text-center mb-5" style="text-decoration: underline;">
            <button type="button" class="btn btn-primary btn-xl" disabled>{{ machine_chosen }}</button>
        </h2>
        <form method="post">
            {% csrf_token %}
            <div id="form-container">
                {% for section in sections %}
                    <div class="card-header">
                        <h5 style="cursor: pointer;">{{ section|capfirst }}</h5>
                    </div>
                    <div class="card-block px-0 py-3">
                        <div class="section-content" id="section-{{ section }}" style="display: none;">
                            {% for field in form %}
                                {% if field.section == section %}
                                    <div class="form-group">
                                        <label for="{{ field.id_for_label }}">{{ field.label }}:</label>
                                        {{ field|add_class:"form-control" }}
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                {% endfor %}
            </div>

            <form method="POST">
                {% csrf_token %}
                <input type="hidden" value="{{ e.eID }}" name="{{name}}ButtonValue">
                <button type="submit" name="{{name}}Button" class="btn btn-success btn-block btn-lg gradient-custom-4 feather icon-play" data-toggle="tooltip" data-placement="top" title="Run execution"></button>
            </form>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var sectionHeaders = document.querySelectorAll('.card-header h5');

    sectionHeaders.forEach(function(header) {
        header.addEventListener('click', function() {
            var sectionContent = this.closest('.card-header').nextElementSibling.querySelector('.section-content');

            if (sectionContent.style.display === 'none' || sectionContent.style.display === '') {
                sectionContent.style.display = 'block';
            } else {
                sectionContent.style.display = 'none';
            }
        });
    });
});
</script>
{% endblock content %}
